<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, width=device-width">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css" integrity="sha512-Evv84Mr4kqVGRNSgIGL/F/aIDqQb7xQ2vcrdIwxfjThSH8CSR7PBEakCr51Ck+w+/U6swU2Im1vVX0SVk9ABhg==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="css/style-nomal.css" type="text/css">
    <link rel="stylesheet" href="css/style.css" type="text/css">
    <script src="https://code.jquery.com/jquery-latest.min.js"></script>
    <title>네이버쇼핑-쇼핑라이브</title>
</head>

<body>
    <div id="index" class="index">
        <div class="wrap">

            <!--APP 알림 신청이 완료된 이후 노출 3초간 유지되고 사라짐-->
            <div id="tost" class="tost-on">
                <ul>
                    <li><img class="coin" src="imgs/asset/icon-alram-on.svg"></li>
                    <li>알림신청 완료!</li>
                </ul>
            </div>

            <!--APP 알림 신청이 해제된 이후 노출 3초간 유지되고 사라짐-->
            <div id="tost" class="tost-off">
                <ul>
                    <li><img class="coin" src="imgs/asset/icon-alram-off.svg"></li>
                    <li>알림을 취소했습니다.</li>
                </ul>
            </div>

            <div id="tost-alram" class="tost-alram">
                <img src="imgs/asset/noti-tost.svg">
            </div>
            <!-- 네비게이션 -->
            <nav>
                <ul class="nav-btn index">
                    <!-- 뒤로가기/ 탭 닫기 -->
                    <!-- 모바일/태블릿 상황에서는 백키 아이콘 / PC에서는 네이버페이 로고 노출됨 -->
                    <li id="close-window" class="back-btn" onclick="closeBtn();">
                        <img class="mo" src="imgs/asset/left-arrow.svg">
                        <img class="pc" src="imgs/asset/IcNewNpayLogo.svg">
                    </li>
                    <!-- 알림 버튼 -->
                    <!-- 눌렀을때 알림의 상태에 따라 알림 확인 및 취소 팝업 노출 -->
                    <!-- app / alram / true 일경우 id="alram-on" imgs/asset/alram-on.svg -->
                    <!-- app / alram / false 일경우 id="alram-off" imgs/asset/alram-off.svg -->
                    <li class="alram" id="alram-off">
                        <img src="imgs/asset/alram-off.svg">
                    </li>
                </ul>
            </nav>

            <div class="contant top">
                <div class="itembox index top-banner">
                    <!-- 상단 배너 -->
                    <!-- live-list에 아이템이 없을경우 style에 Paddin-bottom 1rem 추가됨 -->
                    <ul class="head-banner">
                        <li class="txt">
                            <p class="sub">쇼핑라이브 보고</p>
                            <p class="tit">포인트 받기 
                            </p>
                        </li>
                        <li class="img">
                            <img src="imgs/mission_icon.svg">
                        </li>
                    </ul>

                    <div class="alram-banner">
                        <div class="bottom-banner">
                            <div class="txt">
                                <p>
                                    <img src="imgs/badge/badge_alram.svg">
                                    라이브가 시작하면 알려드릴게요
                                </p>
                                <p>
                                    알림 신청하고 포인트 놓치지 마세요! 🔔
                                </p>
                            </div>
                        </div>
                    </div>

                    <!-- 라이브 쇼핑 리스트(라이브 되고 있는 쇼핑 리스트 4개 까지 보여짐) -->
                    <!-- live-list에 아이템이 없을경우 style에 display : none 추가됨 -->
                    <ul class="live-list">
                    </ul>
                
                </div>

                <!--부킹된 방송이 없다면 해당 Div만 노출됨-->
                <div class="itembox">
                    <div class="no-broad">
                        <div class="noti">
                            <img src="imgs/asset/naga-icon.svg">
                            <div class="txt">
                                <p class="tit">지금은 라이브 방송을 준비 중이에요 👀</p>
                                <p class="sub">알림 신청하면 새로운 방송이 시작될 때 알려드릴게요.</p>
                            </div>
                        </div>
                    </div>
                </div>

            </div>

            <!-- 푸터영역 // 바뀔 여지가 있음 -->
            <!-- 유의사항 변경 // 2026년 1월 8일 -->
            <div class="footer">
                    <p class="header">쇼핑라이브 시청하고 포인트 받기 유의사항</p>
                    <ul>
                        <li>‘쇼핑라이브 시청하고 포인트 받기’ 는 네이버페이와 광고제휴된 네이버 쇼핑라이브 방송을 실시간으로 시청하고 포인트를 받을 수 있는 서비스 입니다.</li>
                        <li >네이버페이는 송출되는 네이버 쇼핑라이브 방송과 관련된 운영, 상품 판매에는 관련이 없습니다. 라이브를 통해 구매한 상품 관련 문의가 있을 경우에는 해당 상품의 판매처에 문의 부탁드립니다.</li>
                        <li> '쇼핑라이브 시청하고 포인트 받기'는 네이버페이 이벤트 페이지를 통해 쇼핑라이브에 방문한 경우에만 적립 가능하며, 다른 경로를 통해 쇼핑라이브에 접속한 경우는 포인트 적립이 불가합니다.</li>
                        <!--삭제
                        <li>진행 중 (On-air) 중인 쇼핑라이브를 5초 이상 시청해야 포인트가 적립됩니다.</li>
                        <li>종료된 쇼핑라이브나 진행 예정인 쇼핑라이브에 대해서는 포인트가 적립되지 않습니다.</li>
                        -->

                        <!--추가-->
                        <li>진행 중 (On-air) 중인 쇼핑라이브는 5초 이상 시청해야 포인트 적립이 됩니다.</li>
                        <li>진행 예정인 쇼핑라이브나, 종료된 라이브는 클릭 후 라이브 뷰어 진입 시에 즉시 포인트 적립이 됩니다.</li>
                        <li>쇼핑라이브 방송 당 진행 예정, 진행 중, 종료 상태에 따라 최대 3회 포인트 적립이 가능하며, 각 상태 별로 최초 1회씩만 적립이 가능합니다.</li>
                        <li>Coming Soon 라이브의 경우, 라이브 시작하는 당일 00시부터 방송 시작 시간 전까지 클릭 포인트 적립이 가능합니다.</li>
                        <li>지난 라이브의 경우, 라이브 종료 이후 종료된 당일 자정까지 클릭 포인트 적립이 가능합니다.</li>

                        <!--삭제
                        <li>쇼핑라이브 방송 당 포인트 리워드는 1회만 지급되며, 중복 참여는 불가합니다.</li>
                        <li>쇼핑라이브 방송 화면에서 5초 이상 머물러야 합니다.</li>
                        -->
                        <li>라이브 진핸 현황은 페이지 접속 시점을 기준으로 표시되며, 이후 방송 종료 등 상태 변경이 실시간으로 반영되지 않을 수 있습니다.</li>
                        <li>일부 네트워크 환경에서는 시청 시간이 정상적으로 기록되지 않을 수 있습니다.</li>
                        <li>해당 서비스는 운영 정책에 따라 예고 없이 변경될 수 있습니다.</li>
                        <li>포인트 지급 관련 문의사항이 있을 경우에는 하단 ‘문의하기’ 통해 접수 부탁드립니다.</li>
                        <li>‘쇼핑라이브 시청하고 포인트 받기’ 광고에 대한 제휴 문의는 하단 ‘이용문의’ 통해 접수 부탁드립니다.</li>
                        <li>쇼핑라이브 시청 후 지급되는 포인트는 서비스 정책에 따라 변경될 수 있습니다.</li>
                        <li>해당 서비스는 운영 정책에 따라 예고 없이 변경될 수 있습니다.</li>
                    </ul>
                </div>

                <!-- 일반 푸터 -->
                <div class="footer-sign">
                    <div class="sign">
                        <p>PINCRUX</p>
                        <p>Copyright PINCRUX. All rights reserved.</p>
                    </div>
                    <div class="btn">
                        <!--cs 호출 버튼-->
                        <p onclick="window.open('#');">이용문의</p>
                    </div>
                </div>

        </div>

        <!-- 알림 팝업 -->
        <!-- 알림 받기 버튼 눌렀을떄 팝업 호출 -->
        <div class="popup alarm-agree">
            <div class="pop-dim"></div>
            <div class="pop-nomal">
                <div class="tit">
                    <p class="head">
                        새로운 라이브가 생기면<br> 알려드릴게요!
                    </p>
                </div>
                <div class="adtxt">
                    <p class="sub">라이브 보고 포인트 받기는 이 페이지에서만<br> 가능해요. 포인트 받을 수 있는 라이브가 <br>시작할 때 알림이 발송됩니다.</p>
                </div>
                <!-- 알림신청서 페이지로 이동 -->
                <div class="sub-btn" id="application" >
                    <p>알림 신청서 보기</p>
                </div>
                <div class="button">
                    <!-- 팝업 닫기 -->
                    <button class="close-btn">닫기</button>
                    <!-- 알림 받기 동작 호출(앱과 연동이 필요함) -->
                    <button class="close-btn" id="agree">알림 받기</button>
                </div>
            </div>
        </div>

        <!-- 알람 취소 팝업 -->
        <!-- 알림 받기 취소 눌렀을떄 팝업 호출 -->
        <div class="popup alarm-disagree">
            <div class="pop-dim"></div>
            <div class="pop-nomal">
                <div class="tit">
                    <p class="head">
                        라이브 시청하고 포인트 받기 <br>알림을 끄시겠어요?
                    </p>
                </div>
                <div class="adtxt">
                    <p class="sub">알림을 끄면 포인트를 받을 수 있는<br>
                    기회를 놓칠 수 있어요.</p>
                </div>
                <!-- 알림신청서 페이지로 이동 -->
                <div class="sub-btn" id="application">
                    <p>알림 신청서 보기</p>
                </div>
                <div class="button">
                    <!-- 팝업 닫기 -->
                    <button class="close-btn">닫기</button>
                    <!-- 알림 받기 취소 동작 호출(앱과 연동이 필요함) -->
                    <button class="close-btn" id="disagree">알림 끄기</button>
                </div>
            </div>
        </div>

        <!-- 오류 팝업 -->
        <div class="popup error">
            <div class="pop-dim"></div>
            <div class="pop-nomal">
                <div class="tit">
                    <p class="head">
                        오류 제목
                    </p>
                </div>
                <div class="adtxt">
                    <p class="sub">오류 문구 입력</p>
                </div>
                <div class="button">
                    <button class="close-btn">확인</button>
                </div>
            </div>
        </div>


    </div>

    <script>

        //알림 토스트 및 관련 버튼 변경 관련 스크립트
        //조건 받는게 조금 까다로워서 알림 취소 동작이 안됨
        //구동하는 플로우의 이해를 돕기위한 스크립트이니 제거하고 다시 만들어주시면 될것같습니다.
        //중간중간 app과 통신도 해야되니.. 제거하고 다시 그리시는게 편할것 같습니다.
        $(function() {
            // === 공용: 토스트 노출 ===
            function showToast($toast) {
                if (!$toast.length) return; // 엘리먼트 없으면 종료
                const prev = $toast.data("timer");
                if (prev) clearTimeout(prev);

                $toast.addClass("active");
                const t = setTimeout(function() {
                    $toast.removeClass("active");
                    $toast.removeData("timer");
                }, 3000);
                $toast.data("timer", t);
            }

            // === 알람 아이콘 클릭: 상태 분기 ===
            $(".alram").off("click.alram").on("click.alram", function() {
                if ($(this).attr("id") === "alram-off") {
                    $(".popup.alarm-agree").fadeIn(200);
                } else {
                    $(".popup.alarm-disagree").fadeIn(200);
                }
            });

            // === 동의 팝업 ===
            // 닫기/딤: agree 버튼(#agree)은 제외
            $(".popup.alarm-agree").off("click.dimClose").on("click.dimClose", ".pop-dim, .close-btn", function(e) {
                if ($(e.target).closest("#agree").length === 0) {
                    $(".popup.alarm-agree").fadeOut(200);
                }
            });

            // [알림 받기] → 토스트 ON + 아이콘 ON
            $(document).off("click.agree").on("click.agree", "#agree", function(e) {
                e.preventDefault();
                e.stopPropagation();

                $(".popup.alarm-agree").fadeOut(200);

                // 토스트(ON) – .tost-on 요소가 있다면 그것을 사용
                const $toastOn = $(".tost-on").length ? $(".tost-on") : $("#tost.tost-on");
                showToast($toastOn);

                // 아이콘 ON 전환
                const $alramLi = $(".alram");
                $alramLi.attr("id", "alram-on");
                $alramLi.find("img").attr("src", "imgs/asset/alram-on.svg");
            });

            // === 해지 팝업 ===
            // 닫기/딤: 확인 버튼(#disagree-confirm)은 제외
            $(".popup.alarm-disagree").off("click.dimClose2").on("click.dimClose2", ".pop-dim, .close-btn", function(e) {
                if ($(e.target).closest("#disagree-confirm").length === 0) {
                    $(".popup.alarm-disagree").fadeOut(200);
                }
            });

            // [확인] → 토스트 OFF + 아이콘 OFF로 복귀
            $(document).off("click.disagree").on("click.disagree", "#disagree-confirm", function(e) {
                e.preventDefault();
                e.stopPropagation();

                $(".popup.alarm-disagree").fadeOut(200);

                // 토스트(OFF) – .tost-off 요소가 있다면 그것을 사용
                const $toastOff = $(".tost-off").length ? $(".tost-off") : $("#tost.tost-off");
                showToast($toastOff);

                // 아이콘 OFF로 복귀
                const $alramLi = $(".alram");
                $alramLi.attr("id", "alram-off");
                $alramLi.find("img").attr("src", "imgs/asset/alram-off.svg");
            });
        });
        //알림 토스트 및 관련 버튼 변경 관련 스크립트

        //카테고리 구동 스크립트
        //스크롤 보정 및 클래스 변경
        //요거는 그냥 쓰셔도 될것 같습니다.
        $(function () {
            const $wrap = $(".cate"); // 가로로 스크롤되는 컨테이너

            // 동적 아이템에도 대응하도록 위임 이벤트
            $wrap.on("click", ".cate-item", function () {
                const $item = $(this);
                const wrapEl = $wrap.get(0);
                const wrapW = $wrap.innerWidth();         // 컨테이너 가로폭
                const itemW = $item.outerWidth(true);     // 마진 포함 아이템 폭
                const cur = $wrap.scrollLeft();           // 현재 스크롤 위치
                const itemLeft = $item.position().left;   // 컨테이너 기준 아이템의 left

                // 아이템 중심을 컨테이너 중심과 일치시키는 목표 스크롤 값
                let target = Math.round(itemLeft + cur + (itemW / 2) - (wrapW / 2));

                // 스크롤 한계 보정
                const max = wrapEl.scrollWidth - wrapEl.clientWidth;
                if (target < 0) target = 0;
                if (target > max) target = max;

                // 부드럽게 스크롤
                $wrap.stop(true).animate({ scrollLeft: target }, 300, "swing");

                // (선택) 활성 상태 표시
                $wrap.find(".cate-item.active").removeClass("active");
                $item.addClass("active");
            });
            });

        // 닫기 버튼
        function closeBtn() {
            window.close();
        }

        // 알림신청서 열기
        $(document).ready(function(){
            $('#application').click(function() {
                var url = "application.html"; // 열고 싶은 URL
                window.open(url, '_blank'); // 새 창으로 열기
            });
        });


        // 라이브 리스트 없는 경우 live-list를 숨김처리하고
        // .head-banner에 패딩 바텀값을 추가함
        // .blank.live-list-blank 나눔선도 숨김처리함
        $(document).ready(function() {
            function checkLiveList() {
                // .live-list 내부에 .list-item 요소가 있는지 확인
                const listItemCount = $('.live-list .list-item').length;

                if (listItemCount === 0) {
                    // 요소가 없을 때
                    $('.live-list, .live-list-bar').hide(); // display: none 처리
                    $('.nav-btn').css('background-color', '#FFEAEB'); // 리스트 없을떄 nav 색상변경됨
                    $('.top-banner').css('background-color', '#FFEAEB'); // 리스트 없을떄 배너 색상변경됨 
                    $('.head-banner').css('padding-bottom', '1rem');
                    $('.2nd').css('padding-top', '2rem');
                } else {
                    // 요소가 하나라도 있을 때
                    $('.live-list, .live-list-blank').show(); // display: block (또는 기존 설정값) 처리
                    $('.nav-btn').css('background-color', '#ffffff'); // 리스트 있을때 배너색상 변경됨
                    $('.top-banner').css('background-color', '#ffffff'); // 리스트 있을떄 배너 색상변경됨 
                    $('.head-banner').css('padding-bottom', '0');
                    $('.2nd').css('padding-top', '2rem');
                }
            }

            // 페이지 로드 시 실행
            checkLiveList();
        });

        //스크롤 56px 밑으로 내려가면 nav 색상 변경됨
        // #FFEAEB → #FFFFFF
        //리스트 내용이 있을때는 원래 nav 색상이 #FFF 여서 연관 없음
        let ticking = false;

        $(window).on('scroll', function () {
            // ⭐ live-list 안에 아이템이 있으면 아무 것도 안 함
            if ($('.live-list .list-item').length > 0) return;

            if (!ticking) {
                window.requestAnimationFrame(function () {
                const scrollTop = $(window).scrollTop();
                const maxScroll = 56;

                // 0 ~ 56 사이 비율
                const ratio = Math.min(scrollTop / maxScroll, 1);

                // #FFEAEB → #FFFFFF
                const startColor = { r: 255, g: 234, b: 235 };
                const endColor   = { r: 255, g: 255, b: 255 };

                const r = Math.round(startColor.r + (endColor.r - startColor.r) * ratio);
                const g = Math.round(startColor.g + (endColor.g - startColor.g) * ratio);
                const b = Math.round(startColor.b + (endColor.b - startColor.b) * ratio);

                $('.nav-btn').css(
                    'background-color',
                    `rgb(${r}, ${g}, ${b})`
                );

                ticking = false;
                });

                ticking = true;
            }
        });

        // 알림 미 신청일때 토스트 팝업
        $(function () {
            const $toast = $('#tost-alram');

            // 실제 알림 신청 여부로 교체
            // 예: window.app?.alarmEnabled === true
            const isAlarmApplied = false;

            if (!isAlarmApplied) {
                // 보여주기
                $toast.addClass('show');

                // 3초 후 숨기기
                setTimeout(() => {
                $toast.removeClass('show').addClass('hide');

                // 애니메이션 끝나면 DOM에서 완전히 숨김(선택)
                setTimeout(() => {
                    $toast.hide();
                }, 200);
                }, 3000);
            } else {
                // 신청되어 있으면 아예 숨김
                $toast.hide();
            }
            });
   
    </script>

</body>
</html>